---
layout:     post
title:      æ’åºç®—æ³•æ±‡æ€»
subtitle:   
date:       2015-11-12
author:     BitLines
header-img: img/post-bg-blog.jpeg
catalog: true
tags:
    - CPP
    - ç®—æ³•ä¸æ•°æ®ç»“æ„
---

## æ’åºç®—æ³•
åœ¨è¯´æ’åºä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€äº›ç®€å•çš„æ¦‚å¿µã€‚  
- **æ’åºï¼ˆsortï¼‰ï¼š** è®¾æœ‰nä¸ªè®°å½•$R_1, R_2,...,R_n$,å­˜æ”¾äºå†…å­˜æˆ–è€…å¤–å­˜ä¸­ã€‚æ’åºçš„ä»»åŠ¡æ˜¯æ‰¾åˆ°$(1,2,â€¦,n)$çš„ä¸€ä¸ªæ’åˆ—$(p_1,p_2,...,p_n)$,ä½¿å¾—$\textup{Key}(R_{p_1}) \le \textup{Key}(R_{p_2}) \le ... \le \textup{Key}(R_{p_n})$ï¼Œå…¶ä¸­key(R)è¡¨ç¤ºRçš„å…³é”®å­—ã€‚
- **ç›´æ¥æ’åºï¼š** å°†åŸå¾…æ’åºçš„nä¸ªè®°å½•é‡æ–°æ•´ç†ä¸º$R_{p_1}, R_{p_2},...,R_{p_n}$,è®°å½•è¢«é‡æ–°ç§»åŠ¨æ•´ç†ã€‚
- **é—´æ¥æ’åºï¼š** å¾…æ’åºçš„nä¸ªè®°å½•ä½ç½®ä¸å˜ï¼Œè€Œæ˜¯ç”¨é¢å¤–çš„çš„ç©ºé—´å­˜å‚¨æ’åˆ—ï¼Œæ’åˆ—ç»“æœæ˜¯(p1,p2,â€¦pn)ã€‚
- **ç¨³å®šæ€§ï¼š** å¦‚æœæ’åºç®—æ³•ä¿æŒæ’åˆ—è®°å½•ä¸­å…³é”®å­—ç­‰ä»·çš„è®°å½•çš„ç›¸å¯¹ä½ç½®ï¼Œç§°æ’åºç®—æ³•æ˜¯ç¨³å®šçš„ã€‚

ä»‹ç»å¥½äº†è¿™äº›æ¦‚å¿µï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹ä¸€äº›æ’åºç®—æ³•ã€‚

### æ’å…¥æ’åº
æ’å…¥æ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯å°†å¾…ç»­çš„åŒºé—´é€æ¸æ‰©å¤§ã€‚å¦‚æœæƒ³è¦å¯¹åŒºé—´[first, last)æ’åºï¼Œæœ€åˆï¼Œåªæœ‰ä¸€ä¸ªå…ƒç´ çš„åŒºé—´[first, first+1)æ˜¯å·²ç»æ’åºçš„ï¼Œå¦‚æœåŒºé—´[first, i)å·²æ’åºï¼Œéœ€è¦å°†*iå…ƒç´ æ’å…¥åˆ°åˆé€‚çš„ä½ç½®ï¼Œä½¿åŒºé—´[first, i]ä»æ˜¯æ’åºçš„ï¼Œé‚£ä¹ˆæ’åºåŒºé—´å°±å¢å¤§äº†ã€‚  
ä¸‹é¢æ˜¯ç®€å•çš„ä»£ç ï¼š
```C++
// å‡è®¾åŒºé—´[first, i)å·²æ’åºï¼Œ
// å°†*iå…ƒç´ æ’å…¥åˆ°åˆé€‚çš„ä½ç½®ä½¿åŒºé—´[first, i]ä»æ˜¯æ’åºçš„

void guarded_linenar_insert(int * first, int * i)
{
    const int value = *i;
    int * prev = i;
    for (--prev; i != first && value < *prev; --prev)
    {
        *i = *prev;
        i = prev;
    }
    *i = value;
}
// å¯¹åŒºé—´[first, last)æ’åº
void guarded_linear_sort(int * first, int * last)
{
    if (first >= last)
    {
       return;
    }
    for (int * i = first; i != last; ++i)
    {
        guarded_linenar_insert(first, i);
    }
}
```
### é€‰æ‹©æ’åº
é€‰æ‹©æ’åºæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯æœ€å°å€¼é€‰æ‹©æ’åºï¼Œå¦ä¸€ç§æ˜¯æœ€å¤§å€¼é€‰æ‹©æ’åºã€‚ä»¥æœ€å°å€¼é€‰æ‹©ä¸ºä¾‹è®²è§£ã€‚
æœ€å°å€¼é€‰æ‹©æ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯åœ¨å¾…æ’åºåŒºé—´[first, last)ä¸­æ‰¾åˆ°æœ€å°å€¼ï¼Œå°†å…¶äº¤æ¢åˆ°firstä½ç½®ï¼Œç„¶åå¯¹[first+1,last)åšåŒæ ·çš„å¤„ç†ã€‚  
ä¸‹é¢æ˜¯ç®€å•çš„ä»£ç ï¼š
```C++
//å‡è®¾å¾…æ’åºå…ƒç´ å­˜æ”¾äº[first,last)ä¸­
//å‡½æ•°æ‰¾å‡º[first,last)ä¸­çš„æœ€å°å…ƒç´ ï¼ŒæŠŠå®ƒäº¤æ¢åˆ°firstä½ç½®ä¸Š
void min_first(int * first, int * last)
{
    int * min_pos = first;
    int temp;
    for (int * i = first + 1; i < last; ++i)
    {
       if (*i < *min_pos)
        {
            min_pos = i;
        }
    }
    temp = *min_pos;
    *min_pos = *first;
    *first = temp;
}
//ä½¿ç”¨æœ€å°å€¼é€‰æ‹©æ’åºï¼Œå¯¹åŒºé—´[first, last)æ’åº
void select_sort(int * first, int * last)
{
    for (0; last â€“ first > 1; ++first)
    {
        min_first(first, last);
    }
}
```

### Shellæ’åº
Shellæ’åºæ˜¯å¯¹æ’å…¥æ’åºçš„æ”¹è¿›ã€‚å¢é‡ä¸ºhçš„æ’å…¥æ’åºï¼Œæ˜¯å¯¹æ•°ç»„ä¸­ä¸‹æ ‡ä¸ºa[0],a[h],a[2h],â€¦a[kh]çš„å…ƒç´ æ’åºã€‚ä¹Ÿå°±æ˜¯ç›¸é‚»çš„å…ƒç´ çš„é—´éš”æ˜¯hã€‚å…±æœ‰hç»„ã€‚å¯¹æ¯ä¸€ç»„ä½¿ç”¨ç®€å•æ’å…¥æ’åºã€‚  
Shellæ’åºç®—æ³•å–å•è°ƒå¢çš„å¢é‡åºåˆ—(h0, h1,â€¦,hk),å…¶ä¸­hk<nã€‚å…ˆå¯¹æ•°ç»„åšhkæ’åºï¼Œå†åšhk-1æ’åºï¼Œä¾æ¬¡ç±»æ¨ã€‚
å®éªŒä¸­è¾ƒå¥½çš„å¢é‡åºåˆ—ä¸ºï¼š  
- $h_i=2^{i+1}-1;$
- $h_i=9(4^i-2^i)+1$

ä¸‹é¢ä»£ç æ˜¯ä½¿ç”¨å¢é‡ä¸º$h_{i+1}=3h_i+1$çš„å¢é‡åºåˆ—ã€‚
```C++
//å‡è®¾å¾…æ’åºå…ƒç´ å­˜æ”¾äº[first,last)ä¸­
//å‡½æ•°å®‰è£…å¢é‡hæ‰¾å‡º[first,last)ä¸­çš„æœ€å°å…ƒç´ ï¼ŒæŠŠå®ƒäº¤æ¢åˆ°firstä½ç½®ä¸Š
void min_first_h(int * first, int * last, int h)
{
    int * min_pos = first;
    int temp;
    for (int * i = first + h; i < last; i += h)
    {
       if (*i < *min_pos)
        {
            min_pos = i;
        }
    }
    temp = *min_pos;
    *min_pos = *first;
    *first = temp;
}
//å‡è®¾å¾…æ’åºå…ƒç´ å­˜æ”¾äº[first,last)ä¸­
//å‡½æ•°å®‰è£…å¢é‡hå¯¹å­åºåˆ—[first,first+h,first+2h,...,last)æ’åº
void h_sort(int * first, int * last, int h)
{
    for (0; last - first > h; first += h)
    {
        min_first_h(first, last, h);
    }
}
//å–å¢é‡åºåˆ—ä¸ºhi+1 = 3hi + 1ï¼Œ
//å¯¹åŒºé—´[first, last)è¿›è¡ŒShellæ’åº
void shell_sort(int * first, int * last)
{
    const int n = last - first;
    int h = 1;
    for (0; h < n; h = 3 * h + 1)
    {
        ;
    }
    for (h = (h - 1) / 3; h > 0; h = (h - 1) / 3)
    {
       for (int i = 0; i < h; ++i)
        {
            h_sort(first + i, last, h);
        }
    }
}
```

### å †æ’åº
å †æ’åºå¯ä»¥çœ‹åšæ˜¯ä¼˜åŒ–åçš„é€‰æ‹©æ’åºã€‚åŸå› æ˜¯å †æ’åºä½¿ç”¨å¤§æ ¹å †è¾…åŠ©æ’åºã€‚å¤§æ ¹å †æ»¡è¶³çš„æ€§è´¨æ˜¯ä»»æ„èŠ‚ç‚¹çš„é”®å€¼éƒ½ä¸å°äºå…¶å·¦å­æ ‘æ‰€æœ‰èŠ‚ç‚¹çš„é”®å€¼æœ€å¤§å€¼ï¼ŒåŒæ—¶ä¹Ÿä¸å°äºå…¶å³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹çš„é”®å€¼æœ€å¤§å€¼ã€‚æ˜¾ç„¶å¤§æ ¹å †çš„å †é¡¶å³æ˜¯å †ä¸­æ‰€æœ‰å…ƒç´ çš„æœ€å¤§å€¼ï¼Œå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æœ€å¤§å€¼ã€‚ç„¶åå°±å¯ä»¥ç”¨ç®€å•çš„å¿«é€Ÿæ’åºåŸç†è¿›è¡Œæ’åºï¼š  
ç®€å•ä»£ç å¦‚ä¸‹ï¼š 
```C++
//å‡è®¾(i, last)æ»¡è¶³å¤§æ ¹å †æ€§è´¨ï¼Œå‡½æ•°åŠ å…¥å…ƒç´ a[i]ï¼Œ
//ä½¿å¾—[i, last)æ»¡è¶³å¤§æ ¹å †
void shift_down(int * a, int i, int last)
{
    int max_c = 0;
    int temp = 0;
    while (true)
    {
        max_c = 2 * i + 1;
        if (max_c >= last)
        {
            return;
        }
        if (max_c + 1 < last && a[max_c] < a[max_c + 1])
        {
            ++max_c;
        }
        if (a[max_c] <= a[i])
        {
            return;
        }
        else
        {
            temp = a[i];
            a[i] = a[max_c];
            a[max_c] = temp;
            i = max_c;
        }
    }
}
//å‡è®¾å¾…æ’åºå…ƒç´ å­˜æ”¾äºa[0, size)ï¼Œå‡½æ•°è°ƒæ•´ä½¿å¾—a[0,size)æ»¡è¶³å¤§æ ¹å †æ€§è´¨
void make_heap(int *a, int size)
{
    for (int half = (size - 2) / 2; half >= 0; --half)
    {
        shift_down(a, half, size);
    }
}
//å‡è®¾å¾…æ’åºå…ƒç´ å­˜æ”¾äºa[0, size),å¹¶ä¸”å·²ç»æ»¡è¶³å¤§æ ¹å †æ€§è´¨
//å‡½æ•°æŠŠå †é¡¶å…ƒç´ a[0]ç§»åŠ¨åˆ°a[size-1]ï¼Œå¹¶é‡æ–°è°ƒæ•´ï¼Œä½¿å¾—
//a[0, size-1)æ»¡è¶³å¤§æ ¹å †æ€§è´¨
void pop_heap(int *a, int size){
    int temp = a[0];
    a[0] = a[size - 1];
    a[size - 1] = temp;
    shift_down(a, 0, size - 1);
}
//å‡è®¾å¾…æ’åºå…ƒç´ å­˜æ”¾äºa[0, size)ï¼Œå‡½æ•°ä½¿ç”¨å †æ’åºå¯¹åŒºé—´[0, size)æ’åº
void heap_sort(int * a, int size)
{
    make_heap(a, size);
    for (0; size >= 1; --size) {
        pop_heap(a, size);
    }
}
```

### å¿«é€Ÿæ’åº
å¿«é€Ÿæ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯åˆ†æ²»æ³•ã€‚å¿«é€Ÿæ’åºæ¯æ¬¡é€‰å®šä¸€ä¸ªæ ‡å‡†ï¼Œç§°ä¸ºæ¢è½´ï¼ˆpivotï¼‰p,å°†å¾…æ’åºå¯¹è±¡åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œ[first, mid)å’Œ[mid, last),ä½¿å¾—[first, mid)ä¸­çš„å…ƒç´ å°äºpï¼Œ[mid, last)ä¸­çš„å…ƒç´ å¤§äºç­‰äºpã€‚é€šå¸¸é€‰å–çš„pæ˜¯å¾…æ’åºå¯¹è±¡çš„æŸä¸ªå…ƒç´ ï¼Œè¿™æ ·å¯ä»¥æŠŠå¾…æ’åºå¯¹è±¡åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†[first, mid), midå’Œ[mid+1, last)ï¼Œå…¶ä¸­[first, mid)ä¸­çš„å…ƒç´ å°äºpï¼Œ[mid, last)ä¸­çš„å…ƒç´ å¤§äºç­‰äºpï¼Œmidä½ç½®çš„å…ƒç´ ç­‰äºpã€‚åªè¦é€’å½’æ‰§è¡Œè¿™ç§åˆ’åˆ†æ“ä½œå°±å¯ä»¥æ’åºäº†ã€‚  
ä¸‹é¢æ˜¯ç®€å•ä»£ç ï¼š
```C++
//é€‰å®šfirstä¸Šçš„å…ƒç´ ä½œä¸ºæ¢è½´pivotï¼Œå°†[first, last)åˆ’åˆ†ä¸º3ä¸ªéƒ¨åˆ†
//[frist,mid)ä¸­å…ƒç´ å°äºpivotï¼Œmidä½ç½®å…ƒç´ ç­‰äºäºpivotï¼Œ[mid+1,last)ä¸­å…ƒç´ å¤§äºç­‰äºpivot
//è¿”å›midæŒ‡é’ˆ
int * partition(int * first, int * last)
{
    if (last - first < 2)
    {
       return first;
    }
    const int pivot = *first;
    while (true)
    {
        for (--last; last != first && *last >= pivot; --last)
        {
            ;
        }
        if (last == first)
        {
            *first = pivot;
           return first;
        }
        else
        {
            *first = *last;
        }
        for (++first; first != last && *first < pivot; ++first)
        {
            ;
        }
        if (first == last)
        {
            *last = pivot;
           return last;
        }
        else
        {
            *last = *first;
        }
    }
}
//ä½¿ç”¨å¿«é€Ÿæ’åºï¼Œå¯¹åŒºé—´[first, last)æ’åº
void quick_sort(int * first, int * last)
{
    if (last - first < 2)
    {
       return;
    }
    int * mid = partition(first, last);
    quick_sort(first, mid);
    quick_sort(mid + 1, last);
}
```
### å½’å¹¶æ’åº
å½’å¹¶æ’åºçš„åŸºæœ¬æ“ä½œæ˜¯å°†ä¸¤ä¸ªå·²ç»æ’å¥½åºçš„å­æ®µå½’å¹¶ä¸ºä¸€ä¸ªå¤§çš„æ’åºæ®µã€‚å¯¹äºæ•°ç»„æ¥è¯´ï¼Œå¯ä»¥å…ˆæŠŠæ•°ç»„åˆ’åˆ†ä¸ºå·¦å³ä¸¤ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«å¯¹ä¸¤ä¸ªå­æ®µæ’åºåï¼Œå†å½’å¹¶ã€‚è¿™æ ·å¯ä»¥ç”¨é€’å½’çš„æ€æƒ³æ¥å®Œæˆã€‚  
ä¸‹é¢æ˜¯å½’å¹¶æ’åºçš„ç®€å•ä»£ç ï¼š
```C++
//å°†åŒºé—´[first, last)æ‹·è´åˆ°[dest,dest+last-first)
void copy(const int * first, const int * last, int * dest)
{
    for (0; first != last; ++first, ++dest)
    {
        *dest = *first;
    }
}
//å‡è®¾åŒºé—´[first1, last1)å’Œ[first2, last2)éƒ½å·²ç»æ’åº
//å‡½æ•°å°†åŒºé—´[first1, last1)å’Œ[first2, last2),åˆå¹¶ä¸ºä¸€ä¸ªæ›´å¤§çš„æ’åºåŒºé—´
//ç»“æœæ‹·è´åˆ°[result,result+last1-first1+last2-first2)
void merge(int * result, const int * first1, const int * last1
    , const int * first2, const int * last2)
{
    for (0; first1 != last1 && first2 != last2; ++result)
    {
        *result = *first1 < *first2 ? *first1++ : *first2++;
    }
    if (first1 != last1)
    {
        copy(first1, last1, result);
    }
    if (first2 != last2)
    {
        copy(first2, last2, result);
    }
}
//ä½¿ç”¨å½’å¹¶æ’åºï¼Œå¯¹åŒºé—´[first,last)æ’åºã€‚
//åŒºé—´[temp, temp+last-first)ä½œä¸ºè¾…åŠ©ç©ºé—´
//ç»“æœä¿å­˜åœ¨åŒºé—´[first,last)
void merge_sort(int * first, int * last, int *temp)
{
    int * mid = first + (last - first) / 2;
    if (first >= mid)
    {
       return;
    }
    merge_sort(first, mid, temp);
    merge_sort(mid, last, temp);
    merge(temp, first, mid, mid, last);
    copy(temp, temp + (last - first), first);
}
```

### åŸºæ•°æ’åº
åŸºæ•°æ’åºé€‚ç”¨äºæ•°æ®ä¸ºæ•´å‹æˆ–è€…å¯ä»¥è½¬æ¢ä¸ºæœ‰æ•´å‹é”®å€¼çš„å¾…æ’åºå…ƒç´ ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯å…ˆå¯¹å¾…æ’åºåŒºé—´å®‰ç…§æœ€é«˜ä½æ’åºï¼Œå†æŒ‰æ¬¡é«˜ä½æ’åºï¼Œä¸€æ¬¡ç±»æ¨ï¼Œç›´åˆ°å¯¹æœ€æœ«ä½æ’åºä¸ºæ­¢ã€‚ä»£ç ç•¥ã€‚ 

## å„ç±»æ’åºç®—æ³•æ€§èƒ½æ¯”è¾ƒ
è¿™æ‰æ˜¯çœŸæ­£çš„å¹²è´§ ğŸ˜ºã€‚

|   æ’åºç®—æ³•    |   æœ€ä½³æƒ…å½¢    |   æœ€å·®æƒ…å½¢    |   å¹³å‡    |   ç©ºé—´ |  ç¨³å®šæ€§ |
|   ----        |   ----    |   ----    | ----  | ----  |   ----    |
|   æ’å…¥æ’åº    |   n-1 |   n (n-1) / 2 |   n (n-1) / 4 |   åŸåœ°    |   ç¨³å®š    |
|   é€‰æ‹©æ’åº    |   n (n-1) / 2 |   n (n-1) / 2 |   n (n-1) / 2 |   åŸåœ°    |   ç¨³å®š    |
|   å¸Œå°”æ’åº    |   -   |   -   |   O(n5/4) |   åŸåœ°    |   ä¸ç¨³å®š  |
|   å †æ’åº  |   O(n)+nlog2n |   O(n)+nlog2n |   O(n)+nlog2n |   åŸåœ°    |   ä¸ç¨³å®š  |
|   å¿«é€Ÿæ’åº    |   nlog2n  |   n(n+1)/2    |   nlog2n  |   åŸåœ°    |   ä¸ç¨³å®š  |
|   å½’å¹¶æ’åº    |   nlog2n  |   nlog2n  |   nlog2n  |   O(n)    |   ç¨³å®š
|   åŸºæ•°æ’åº    |   O(d(n+radix))   |   O(d(n+radix))   |   O(d(n+radix))   |   O(n)    |   ç¨³å®š    |